<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Resources - Understanding Bevy</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <link rel="stylesheet" href="../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../ecs/_index.html"><strong aria-hidden="true">2.</strong> Entities, Components and Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ecs/entities.html"><strong aria-hidden="true">2.1.</strong> Entities</a></li><li class="chapter-item expanded "><a href="../../ecs/components.html"><strong aria-hidden="true">2.2.</strong> Components</a></li><li class="chapter-item expanded "><a href="../../ecs/systems.html"><strong aria-hidden="true">2.3.</strong> Systems, Queries and Query Filters</a></li><li class="chapter-item expanded "><a href="../../ecs/communication/_index.html"><strong aria-hidden="true">2.4.</strong> Tools for Intersystem Communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ecs/communication/resources.html" class="active"><strong aria-hidden="true">2.4.1.</strong> Resources</a></li><li class="chapter-item expanded "><a href="../../ecs/communication/commands.html"><strong aria-hidden="true">2.4.2.</strong> Commands</a></li><li class="chapter-item expanded "><a href="../../ecs/communication/events.html"><strong aria-hidden="true">2.4.3.</strong> Events</a></li><li class="chapter-item expanded "><a href="../../ecs/communication/chaining.html"><strong aria-hidden="true">2.4.4.</strong> Chaining Systems</a></li></ol></li><li class="chapter-item expanded "><a href="../../ecs/timing/_index.html"><strong aria-hidden="true">2.5.</strong> Control Flow and Timing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ecs/timing/scheduling.html"><strong aria-hidden="true">2.5.1.</strong> System Scheduling and Stages</a></li><li class="chapter-item expanded "><a href="../../ecs/timing/stages.html"><strong aria-hidden="true">2.5.2.</strong> Stages</a></li><li class="chapter-item expanded "><a href="../../ecs/communication/conditional-systems.html"><strong aria-hidden="true">2.5.3.</strong> Run Criteria and States</a></li><li class="chapter-item expanded "><a href="../../ecs/timing/timers.html"><strong aria-hidden="true">2.5.4.</strong> Timers and Time Steps</a></li></ol></li><li class="chapter-item expanded "><a href="../../ecs/internals/_index.html"><strong aria-hidden="true">2.6.</strong> ECS Internals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ecs/internals/app-builder.html"><strong aria-hidden="true">2.6.1.</strong> App Builder</a></li><li class="chapter-item expanded "><a href="../../ecs/internals/world.html"><strong aria-hidden="true">2.6.2.</strong> World</a></li><li class="chapter-item expanded "><a href="../../ecs/internals/default-plugins.html"><strong aria-hidden="true">2.6.3.</strong> Default Plugins</a></li><li class="chapter-item expanded "><a href="../../ecs/internals/archetypes.html"><strong aria-hidden="true">2.6.4.</strong> Archetypes</a></li><li class="chapter-item expanded "><a href="../../ecs/internals/reflection.html"><strong aria-hidden="true">2.6.5.</strong> Reflection</a></li></ol></li><li class="chapter-item expanded "><a href="../../ecs/think-ecs.html"><strong aria-hidden="true">2.7.</strong> Think ECS: Idiomatic Problem Solving in Bevy</a></li></ol></li><li class="chapter-item expanded "><a href="../../organization/_index.html"><strong aria-hidden="true">3.</strong> Organizing Your Bevy Codebase</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../organization/project-structure.html"><strong aria-hidden="true">3.1.</strong> Project Structure</a></li><li class="chapter-item expanded "><a href="../../organization/plugins.html"><strong aria-hidden="true">3.2.</strong> Plugins</a></li><li class="chapter-item expanded "><a href="../../organization/scenes.html"><strong aria-hidden="true">3.3.</strong> Scenes</a></li></ol></li><li class="chapter-item expanded "><a href="../../serialization/_index.html"><strong aria-hidden="true">4.</strong> Serialization and Networking</a></li><li class="chapter-item expanded "><a href="../../graphics/_index.html"><strong aria-hidden="true">5.</strong> Graphics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../graphics/assets.html"><strong aria-hidden="true">5.1.</strong> Assets</a></li><li class="chapter-item expanded "><a href="../../graphics/transforms.html"><strong aria-hidden="true">5.2.</strong> Transforms</a></li><li class="chapter-item expanded "><a href="../../graphics/children.html"><strong aria-hidden="true">5.3.</strong> Hierarchy: Parents and Children</a></li><li class="chapter-item expanded "><a href="../../graphics/animation.html"><strong aria-hidden="true">5.4.</strong> Animation</a></li><li class="chapter-item expanded "><a href="../../graphics/shaders.html"><strong aria-hidden="true">5.5.</strong> Shaders</a></li><li class="chapter-item expanded "><a href="../../graphics/vector_graphics.html"><strong aria-hidden="true">5.6.</strong> Vector Graphics</a></li></ol></li><li class="chapter-item expanded "><a href="../../ui/_index.html"><strong aria-hidden="true">6.</strong> User Interfaces</a></li><li class="chapter-item expanded "><a href="../../audio/_index.html"><strong aria-hidden="true">7.</strong> Audio</a></li><li class="chapter-item expanded "><a href="../../input/_index.html"><strong aria-hidden="true">8.</strong> Input</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../input/keyboard.html"><strong aria-hidden="true">8.1.</strong> Keyboard</a></li><li class="chapter-item expanded "><a href="../../input/mouse.html"><strong aria-hidden="true">8.2.</strong> Mouse</a></li><li class="chapter-item expanded "><a href="../../input/controller.html"><strong aria-hidden="true">8.3.</strong> Controller</a></li><li class="chapter-item expanded "><a href="../../input/touch.html"><strong aria-hidden="true">8.4.</strong> Touch</a></li></ol></li><li class="chapter-item expanded "><a href="../../physics/_index.html"><strong aria-hidden="true">9.</strong> Physics</a></li><li class="chapter-item expanded "><a href="../../development/_index.html"><strong aria-hidden="true">10.</strong> Productive Development in Bevy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../development/compiling.html"><strong aria-hidden="true">10.1.</strong> Compiling your Game</a></li><li class="chapter-item expanded "><a href="../../development/testing.html"><strong aria-hidden="true">10.2.</strong> Idiomatic Automated Testing</a></li><li class="chapter-item expanded "><a href="../../development/diagnostics.html"><strong aria-hidden="true">10.3.</strong> Diagnostics and Debugging</a></li><li class="chapter-item expanded "><a href="../../development/cross-platform.html"><strong aria-hidden="true">10.4.</strong> Cross-Platform Support</a></li><li class="chapter-item expanded "><a href="../../development/releasing.html"><strong aria-hidden="true">10.5.</strong> Releasing your Game</a></li><li class="chapter-item expanded "><a href="../../development/common-issues.html"><strong aria-hidden="true">10.6.</strong> Common Issues and Finding Help</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Understanding Bevy</h1>

                    <div class="right-buttons">
                        
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#resources" id="resources">Resources</a></h1>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/ecs/trait.Resource.html">Resources</a> are global singletons, accessed by their type, which can be used to store global state.
You might want to use resources for storing and configuring settings, handling a complex data structure like a player's inventory that doesn't fit naturally into the ECS model, or tracking game state like the player's score.</p>
<p>You can use virtually any Rust type as a resource, but if possible, you're going to want your resources to be thread-safe: <code>'static</code> lifetime and <code>Send + Sync</code>.</p>
<h2><a class="header" href="#creating-resources" id="creating-resources">Creating Resources</a></h2>
<p>Assuming that we're working with a thread-safe resource that isn't system local, there are two different ways we can add resources to our app.</p>
<p>When you're working with your <a href="../internals/app-builder.html"><code>AppBuilder</code></a> (including through a <a href="../../organization/plugins.html">plugin</a>), there are two ways to add resources:</p>
<ol>
<li>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/app/struct.AppBuilder.html#method.init_resource"><code>init_resource</code></a>, which adds a resource of the type specified in its type parameter, with a starting value given by its <code>Default</code> trait.</p>
</li>
<li>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/app/struct.AppBuilder.html#method.add_resource"><code>.add_resource</code></a>, which sets a custom starting value for that type.</p>
</li>
</ol>
<p>Use <code>.init_resource</code> when you're not sure what data you need in the resource at the time of its creation, and use <code>.add_resource</code> when you have a good starting value.</p>
<p>If you need to add or overwrite Resources at run-time, consider using <a href="commands.html">commands</a> with the <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.Commands.html#method.insert_resource">.insert_resource</a> method, which works the same as <code>.add_resource</code> above. Be mindful though: commands don't take effect until the end of each stage. Most of the time, you shouldn't need to do this: to modify a resource, instead create a system that gets a <code>ResMut</code> to the resource in question, then modify it within that system.</p>
<p>Here's how you might add resources of various types for a mock RTS game:</p>
<pre><pre class="playground"><code class="language-rust">#![allow(warnings)]
use bevy::prelude::*;

struct InfantryStats {
    hp: f32,
    damage: f32,
    speed: f32,
}

// In order to use .init_resource, we need to specify a default starting value
// by implementing the Default trait
impl Default for InfantryStats {
    fn default() -&gt; Self {
        InfantryStats {
            hp: 10.0,
            damage: 2.0,
            speed: 1.0,
        }
    }
}

struct PlayerResources {
    gold: usize,
    wood: usize,
}

struct InitialPosition(i32, i32);

enum PlayerColor {
    Red,
    Blue,
    Pink,
}

fn main() {
    App::build()
        .init_resource::&lt;InfantryStats&gt;()
        // Ordinary structs, tuple structs and enums can all be used as resources
        .add_resource(PlayerResources {
            gold: 1000,
            wood: 500,
        })
        .add_resource(InitialPosition(0, 0))
        .add_resource(PlayerColor::Pink)
        .run();
}
</code></pre></pre>
<h3><a class="header" href="#thread-local-resources" id="thread-local-resources">Thread-local Resources</a></h3>
<p>If you need a resource that is not thread-safe, you first need to create it with: <a href="https://docs.rs/bevy/0.4.0/bevy/app/struct.AppBuilder.html#method.add_thread_local_resource"><code>.add_thread_local_resource</code></a> or <a href="https://docs.rs/bevy/0.4.0/bevy/app/struct.AppBuilder.html#method.init_thread_local_resource"><code>.init_thread_local_resource</code></a>, whose behavior corresponds to the <code>add_resource</code> and <code>init_resource</code> methods described above. </p>
<p>You might need to use resources that aren't thread-safe when:</p>
<ul>
<li>working with exceptionally large objects that you don't want to pass across threads</li>
<li>handling audio-processing</li>
<li>handling network-queues</li>
<li>manipulating reference-counted objects</li>
</ul>
<p>Be aware: thread-local resources created in this way are a completely distinct concept from those created with the <code>.insert_local_resource</code> method, which use the <code>Local</code> resource smart pointer, which creates a unique instantiation of the resource in the system it is referred to.</p>
<p>Once you have your thread-local resource, you need to use &quot;thread-local systems&quot; (see the corresponding <a href="../systems.html">section</a> in this book for more information) to manipulate it, which gives you a complete global lock on the entire <a href="https://docs.rs/bevy/0.4.0/bevy/app/struct.App.html">app</a>, with <code>World</code> and all of its <code>Resources</code>.</p>
<p>You can see how you might use thread-local resources in <a href="../systems.html">thread-local systems</a>.</p>
<h3><a class="header" href="#system-local-resources" id="system-local-resources">System-Local Resources</a></h3>
<p>System-local resources are scoped, mutable resources that are only available in the system that created them. Their state persists between time steps, but not between distinct systems created using the same function, as they work off of the <code>SystemId</code> created at their time of registration.</p>
<p>In typical use, system-local resources are created implicitly, through the use of a <code>Local</code> resource smart-pointer type on one of the function arguments in your system. If you had some reason to manually create or overwrite them, you could instead use <a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.Commands.html#method.insert_local_resource"><code>.insert_local_resource</code></a>.</p>
<p>Local resources are a fairly niche tool: use them if you want to track state that will only ever be relevant to a single system that you need to persist across frames. The <a href="https://github.com/bevyengine/bevy/blob/master/examples/ecs/event.rs">official example</a> for <a href="events.html">Events</a> show how you can use them to create an<code>EventReader</code>, which could persist across frames if not all events were processed in the available time. When you want to have many similar, but distinct systems, you can use system-local resources in combination with generics to get interesting specialization, as shown in this overly-complex <code>Timer</code> example:</p>
<pre><pre class="playground"><code class="language-rust">use bevy::prelude::*;

// By defining a trait, we can ensure that all of our types
// have the required common functionality
trait MyTimer {
	fn access(&amp;mut self) -&gt; &amp;mut Timer;
}

struct SlowTimer(Timer);
struct FastTimer(Timer);

impl Default for FastTimer {
	fn default() -&gt; Self {
		FastTimer(Timer::from_seconds(0.3, true))
	}
}

impl Default for SlowTimer {
	fn default() -&gt; Self {
		SlowTimer(Timer::from_seconds(2.0, true))
	}
}

impl MyTimer for FastTimer {
	fn access(&amp;mut self) -&gt; &amp;mut Timer {
		&amp;mut self.0
	}
}

impl MyTimer for SlowTimer {
	fn access(&amp;mut self) -&gt; &amp;mut Timer {
		&amp;mut self.0
	}
}

fn main() {
	App::build()
		.add_plugins(MinimalPlugins)
		// We can customize two otherwise identical systems by specifying its type
		.add_system(run_timer::&lt;SlowTimer&gt;.system())
		// The timer resource in these two systems are distinct
		.add_system(run_timer::&lt;FastTimer&gt;.system())
		.run();
}

// System-local resources initialize their value with their
// The trait bounds are needed to ensure that any T we might provide will work
fn run_timer&lt;T: Send + Sync + Default + 'static + MyTimer&gt;(time: Res&lt;Time&gt;, mut timer: Local&lt;T&gt;) {
	if timer.access().tick(time.delta_seconds()).just_finished() {
		println!(&quot;The time is {:?}&quot;, *time);
	}
}
</code></pre></pre>
<h2><a class="header" href="#ensuring-unique-resource-types" id="ensuring-unique-resource-types">Ensuring Unique Resource Types</a></h2>
<p>When any of the resource creation methods is called on a type that already exists (with the caveat that system-local resources are effectively scoped), Bevy will overwrite any existing data. As a result, you only ever want to have one resource of a given type in your app at once.</p>
<p>Here are a few patterns you can use to ensure that your resources have a unique type:</p>
<pre><pre class="playground"><code class="language-rust">// In this example, we need many different Resources that use an f32 to store its data
use bevy::prelude::*;
use std::ops::{Deref, DerefMut};

// Creating a type alias for f32
type Score = f32;

// Creating a simple tuple struct using the 'newtype' pattern
// You can do the exact same thing with an ordinary struct if you want the field name
struct FallingThreshold(f32);

// Adding the Deref trait makes these simple structures much more pleasant to work with
// You always want the inner data anyways
impl Deref for FallingThreshold {
    type Target = f32;

    fn deref(&amp;self) -&gt; &amp;Self::Target {
        &amp;self.0
    }
}

impl DerefMut for FallingThreshold {
    fn deref_mut(&amp;mut self) -&gt; &amp;mut f32 {
        &amp;mut self.0
    }
}

// Creating a marker struct to combine with our data as a tuple type
// You could easily reuse these as marker components as well
struct Friendly;
struct Hostile;

fn main() {
    App::build()
        // Don't do this: it's really hard to debug and read
        // And also hard to extend with new behavior or traits
        .add_resource(1.0 as f32)
        // This overwrites our previous f32, since type aliasing doesn't create a new type
        .add_resource(2.0 as Score)
        // FallingThreshold is its own type, despite being used like a raw f32
        .add_resource(FallingThreshold(3.0))
        // (Friendly, f32) and (Hostile, f32) are unique types, disambiguating properly
        .add_resource((Friendly, 4.0))
        .add_resource((Hostile, 5.0))
        .run();
}
</code></pre></pre>
<h2><a class="header" href="#using-resources-in-your-systems" id="using-resources-in-your-systems">Using Resources in Your Systems</a></h2>
<p>In order to access resources in a system, wrap the resource type in your function parameters in one of the three smart-pointers.</p>
<ol>
<li>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.Res.html"><code>Res</code></a>, for when you want read-only access to the underlying data.</p>
</li>
<li>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.ResMut.html"><code>ResMut</code></a>, for when you want read and write access to the data.</p>
</li>
<li>
<p><a href="https://docs.rs/bevy/0.4.0/bevy/ecs/struct.Local.html"><code>Local</code></a>, for when you want a system-local resource.</p>
</li>
</ol>
<p>These resource smart pointers all <code>impl Deref</code>, ensuring that rather than needing to call <code>*my_resource</code> each time, you can usually implicitly skip the dereferencing with <code>my_resource</code>. </p>
<p>When you define a system, you can include resources as one of your function parameter. Bevy's scheduler automatically looks for a  previously added resources with a matching type, and passes in a reference of the appropriate type to your system.</p>
<p>We can see the differences between these different resource types in this simple example:</p>
<pre><pre class="playground"><code class="language-rust">use bevy::prelude::*;
use rand::Rng;
use std::collections::HashMap;
use std::fmt;

#[derive(Clone)]
struct Score(u32);

// These derives let us use Player as a key in our HashMap later
#[derive(Hash, PartialEq, Eq, Clone, Copy)]
enum Player {
	Player1,
	Player2,
}

struct Winner(Player);

// The Display trait lets us control how these types are printed
impl core::fmt::Display for Score {
	fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
		write!(f, &quot;{}&quot;, self.0)
	}
}

impl core::fmt::Display for Player {
	fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
		write!(
			f,
			&quot;{}&quot;,
			match &amp;self {
				Player::Player1 =&gt; &quot;Player 1&quot;,
				Player::Player2 =&gt; &quot;Player 2&quot;,
			}
		)
	}
}

impl core::fmt::Display for Winner {
	fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
		write!(f, &quot;{}&quot;, self.0)
	}
}

fn main() {
	App::build()
		.add_plugins(MinimalPlugins)
		// Compound types like this are their own type, so can be fetched nicely by our scheduler
		.init_resource::&lt;HashMap&lt;Player, Score&gt;&gt;()
		.add_startup_system(initialize_scores.system())
		// By the completely unfair rules of our game, Player1 wins ties
		.add_resource(Winner(Player::Player1))
		.add_system(update_score.system())
		.add_system(determine_winner.system())
		.add_system(show_winner.system())
		.run();
}

// Rather than trying to specify a starting value at compile time, we can initialize it with its Default value
// Then we can set it within a system using more complex logic
fn initialize_scores(mut score_map: ResMut&lt;HashMap&lt;Player, Score&gt;&gt;) {
	score_map.insert(Player::Player1, Score(0));
	score_map.insert(Player::Player2, Score(0));
}

// We're modifying the score_map here, so we need to access them mutably with ResMut
// Note that we need mut in front of the parameter name as well
fn update_score(mut score_map: ResMut&lt;HashMap&lt;Player, Score&gt;&gt;) {
	let mut rng = rand::thread_rng();

	for (_, score) in score_map.iter_mut() {
		// We need to access the 0th field of our simple tuple struct Score
		*score = Score(score.0 + rng.gen_range(0..10));
	}
}

// We're only reading our score_map, but need to write to our winner parameter
fn determine_winner(score_map: Res&lt;HashMap&lt;Player, Score&gt;&gt;, mut winner: ResMut&lt;Winner&gt;) {
	// Notice how Rust automatically derefences score_map here
	// This works when we're trying to assign a resource or component to a value
	// Or when we're using a method doesn't exist on our wrapper typ
	let player_1_score = score_map.get(&amp;Player::Player1).unwrap();
	let player_2_score = score_map.get(&amp;Player::Player2).unwrap();

	// You can impl std::comp::Ord on your types to overload your comparison operators
	if player_1_score.0 &gt;= player_2_score.0 {
		// The automatic dereferencing doesn't work here, because we're trying to assign to, rather than access the value
		// So Rust can't infer what we want to do
		*winner = Winner(Player::Player1);
	} else {
		*winner = Winner(Player::Player2);
	}
}

// Finally, we just need to read the scores and winner to print them
fn show_winner(score_map: Res&lt;HashMap&lt;Player, Score&gt;&gt;, winner: Res&lt;Winner&gt;) {
	let player_1_score = score_map.get(&amp;Player::Player1).unwrap();
	let player_2_score = score_map.get(&amp;Player::Player2).unwrap();

	println!(&quot;Player 1's score: {}&quot;, player_1_score);
	println!(&quot;Player 2's score: {}&quot;, player_2_score);
	// We want to print the winner, not the reference to the winner
	println!(&quot;Right now, {} is the winner!&quot;, *winner);
}
</code></pre></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../ecs/communication/_index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../ecs/communication/commands.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../ecs/communication/_index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../ecs/communication/commands.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
